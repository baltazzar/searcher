/**
 * Baltazzar Searcher
 * Versão: 0.1.1
 * Módulo front-end de busca de dados.
 * Autor: Victor Bastos
 */
this.Handlebars=this.Handlebars||{},this.Handlebars.templates=this.Handlebars.templates||{},this.Handlebars.templates["searcher/searcher.tpl"]=Handlebars.template(function(e,t,s,r,a){function n(e,t){var r,a="";return a+='\r\n			<option value="',(r=s.attr)?r=r.call(e,{hash:{},data:t}):(r=e&&e.attr,r=typeof r===o?r.call(e,{hash:{},data:t}):r),a+=l(r)+'">Buscar por ',(r=s.title)?r=r.call(e,{hash:{},data:t}):(r=e&&e.title,r=typeof r===o?r.call(e,{hash:{},data:t}):r),a+=l(r)+"</option>\r\n		"}this.compilerInfo=[4,">= 1.0.0"],s=this.merge(s,e.helpers),a=a||{};var i,c="",o="function",l=this.escapeExpression,h=this;return c+='<div class="row">\r\n	<div class="col-md-2">\r\n		<select class="form-control input-sm search-attrs">\r\n		',i=s.each.call(t,t&&t.searchAttrs,{hash:{},inverse:h.noop,fn:h.program(1,n,a),data:a}),(i||0===i)&&(c+=i),c+='\r\n		</select>\r\n	</div>\r\n	<div class="col-md-4">\r\n		<form class="form-search" action="">\r\n			<div class="input-group">\r\n				<input type="text" class="form-control input-sm search-param" placeholder="Digite sua busca">\r\n				<span class="input-group-btn">\r\n					<button class="btn btn-sm btn-primary btn-search"><i class="glyphicon glyphicon-search"></i></button>\r\n				</span>\r\n			</div>\r\n		</form>\r\n	</div>\r\n</div>'}),define("templates",function(){}),define("views/searcher",["require","exports","module","marionette"],function(e,t,s){var r=e("marionette");e(["../templates"]),s.exports=r.ItemView.extend({template:"searcher/searcher.tpl",events:{"submit .form-search":"doSearch","keyup .search-param":"resetCollection","change .search-attrs":function(){this.$(".search-param").focus()}},initialize:function(e){this.options=e,this.model=new Backbone.Model({}),this.setSearchAttrs(),this.render(),this.options.logTemplate&&this.logTemplate()},logTemplate:function(){var e=this.el.innerHTML;e=e.replace(/\n\n/g,"\n"),console.log("#################### TEMPLATE DO SEARCHER ####################\n"),console.log(e)},setSearchingText:function(e){var t=this.options.searchingText?this.options.searchingText:"Buscando...";e?this.$(".btn-search").html(this.prevState):(this.prevState=this.$(".btn-search").html(),this.$(".btn-search").html(t))},resetCollection:function(e){e.preventDefault();var t=_.omit(this.collection.queryObj,"filter_fields"),s=this;""==e.currentTarget.value&&(this.setSearchingText(),setTimeout(function(){s.collection.callFetch(t).success(function(){s.setSearchingText("reset")})},100))},doSearch:function(e){e.preventDefault();var t=this.$(".search-attrs"),s=this.$(".search-param"),r={filter_fields:t.val()+"%"+s.val()},a=this;this.setSearchingText(),setTimeout(function(){""!=s&&a.collection.callFetch(r).success(function(){a.setSearchingText("reset")})},100)},setSearchAttrs:function(){var e=[];_.each(this.options.searchAttrs,function(t,s){e.push({attr:s,title:t})}),this.model.set("searchAttrs",e)}})}),define("searcher",["require","exports","module","jquery","./views/searcher"],function(e){var t=e("jquery"),s=e("./views/searcher");t.fn.Searcher=function(e){return e.el=this,new s(e)}});